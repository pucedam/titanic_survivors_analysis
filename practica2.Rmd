---
title: "Práctica 2: Limpieza y análisis de datos"
author: "Pedro Uceda Martínez, Pablo Campillo Sánchez"
date: '`r format(Sys.Date(),"%e de %B, %Y")`'
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(ggplot2)
library(plyr)
library(dplyr)
library(gridExtra)
library(pROC)

```

# 1. Descripción del dataset

Durante esta práctica vamos a tratar el _dataset_ base de la competición [**Titanic - Machine Learning from Disaster**](https://www.kaggle.com/c/titanic/overview). En este conjunto de datos se nos presenta, para cada pasajero del tan famoso trasatlántico, sus datos personales más importantes, así como otros relacionados con su embarque en el Titanic, y si finalmente sobrevivieron al naufragio del mismo.

De este modo, este estudio es interesante dado que examinaremos qué posibles factores pudieron influir en la supervivencia de los pasajeros. Así, podremos, por ejemplo, ver si solamente la clase del billete el género (mujeres) y la edad (niños) condicionaron que un viajero se salvase tal y como hemos visto en la gran pantalla o bien hubiera habido otros factores que pudieran haber determinado la supervivencia del pasajero, como el número de billete.

Las variables de las que disponemos, para cada pasajero, son:

- **PassengerId**: Identificador artifical del pasajero.
- **survived**: Si sobrevivió (1) o no (0).
- **Pclass**: Clase del pasaje. 
- **Name**: Nombre del pasajero.
- **sex**: Sexo del viajero.
- **Age**: Edad, en años.
- **sibsp**: Número de hermanos o esposas a bordo del Titanic
- **parch**: Número de padres / hijos a bordo del Titanic
- **ticket**: Número de ticket
- **fare**: Tarifa del pasaje
- **cabin**: Número de camarote
- **embarked**: Puerto desde el que embarcó el pasajero. Las posibles opciones son: Cherbourg(C), Queenstown(Q) o Southampton(s).

A continuación procedemos a cargar el __dataset__, sin __factors__, para evitar tratar los nombres de los pasajeros como tales.
```{r}


ds <- read.csv(file = "train.csv", header=TRUE)

str(ds)

```

Los atributos PassengerId y Name no serán objeto de análisis. Para el resto, tenemos las variables cuantitativas Age, SibSp, Parch y Fare, todas correctamente tratadas como int o num. 

También estan las variables cualitativas Ticket, PClass, Sex y  Cabin, cargadas como cadena de caracteres. Nótese que Cabin es susceptible de ser dividida en letra y número.

Para más claridad de los datos, procedemos a realizar las siguientes transformaciones:
- Transformamos el campo dicotómico Survived a Yes(1) y Not(0).
- Transformamos el campo cualitativo categórico Embarked a un factor con 3 posibles valores, cada uno con el nombre del puerto.


```{r}

ds$Survived <- factor(ds$Survived, levels=sort(c(0,1)), labels = c("Not", "Yes"))
ds$Embarked <- factor(ds$Embarked, levels=sort(c("C", "Q", "S")), labels = c("Cherbourg", "Queenstown", "Southampton"))


str(ds)

```

A continuación analizamos cada uno de los distintos atributos:

```{r}

summary(ds)

#Visualización de variables cuantitativas

#Age
g1 <- ggplot(ds, aes(x=Age)) + geom_boxplot()

g2 <- ggplot(ds, aes(x=Age)) + geom_histogram(bins=20)



```


```{r}

grid.arrange(g1,g2,nrow=2)

```